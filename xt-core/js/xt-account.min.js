jQuery(function(a){function g(c,b){a("#X_Account-Right").html('<div id="X_Account-Loading" class="xt-loading"></div>');a.ajax({type:"get",dataType:"html",url:XT.ajaxurl+"?rand="+Math.random(),data:{action:"xt_ajax_account_right",module:c},success:function(d){a("#X_Account-Right").html(d);typeof b!="undefined"&&b(d)}})}function o(c,b){a.ajax({type:"post",dataType:"json",url:XT.ajaxurl+"?rand="+Math.random(),data:{action:"xt_ajax_account_unbind",type:c},success:function(d){typeof b!="undefined"&&b(d)}})}
function p(c,b,d){a.ajax({type:"post",dataType:"json",url:XT.ajaxurl+"?rand="+Math.random(),data:{action:"xt_ajax_account_bind_setting",type:c,setting:b},success:function(e){typeof d!="undefined"&&d(e)}})}function n(c,b,d,e,f,h){a.ajax({type:"post",dataType:"html",url:XT.ajaxurl+"?rand="+Math.random(),data:{action:"xt_ajax_account_orders",type:c,platform:b,page:d,sd:e,ed:f},success:function(q){typeof h!="undefined"&&h(q)}})}function j(c){$sd=a("#X_Account-Order-StartDate").val();$ed=a("#X_Account-Order-EndDate").val();
$platform=a("#X_Account-Order-Type li.active a").attr("data-value");a("#X_Account-Order-List").html('<div id="X_Account-Loading" class="xt-loading"></div>');n("order",$platform,c,$sd,$ed,function(b){a("#X_Account-Order-List").html(b);a("#X_Pagination-Bottom .page-numbers").click(function(){j(a(this).attr("href").replace("#",""));return false})})}function i(c){$sd=a("#X_Account-Unorder-StartDate").val();$ed=a("#X_Account-Unorder-EndDate").val();$platform=a("#X_Account-Unorder-Type li.active a").attr("data-value");
a("#X_Account-Unorder-List").html('<div id="X_Account-Loading" class="xt-loading"></div>');n("unorder",$platform,c,$sd,$ed,function(b){a("#X_Account-Unorder-List").html(b);a("#X_Pagination-Bottom .page-numbers").click(function(){i(a(this).attr("href").replace("#",""));return false});a(".xt-unorder-open").click(function(){XT.modal("\u627e\u56de\u6211\u7684\u8ba2\u5355",'<div class="form-horizontal"><div class="control-group"><label class="control-label" for="X_Unorder-TradeId" style="width:80px;">\u8ba2\u5355\u53f7\uff1a</label><div class="controls" style="margin-left:100px"><div class="input-append"><input type="text" id="X_Unorder-TradeId"><button class="btn" type="button" id="X_Unorder-Submit">\u786e\u8ba4</button></div></div></div></div>',
"xt-unorder-popup");a("#X_Unorder-Submit").attr("data-id",a(this).attr("data-id")).attr("data-platform",a(this).attr("data-platform"));return false})})}function r(c,b,d,e,f){a.ajax({type:"post",dataType:"html",url:XT.ajaxurl+"?rand="+Math.random(),data:{action:"xt_ajax_account_tuiguang",type:c,page:b,sd:d,ed:e},success:function(h){a("#X_Account-Tuiguang-List").html(h);typeof f!="undefined"&&f(h)}})}function s(c,b,d){a.ajax({type:"post",dataType:"html",url:XT.ajaxurl+"?rand="+Math.random(),data:{action:"xt_ajax_account_jifen",
type:c,page:b},success:function(e){a("#X_Account-Jifen-List").html(e);typeof d!="undefined"&&d(e)}})}function l(c){$type=a("#X_Account-Jifen-Type li.active a").attr("data-value");a("#X_Account-Jifen-List").html('<div id="X_Account-Loading" class="xt-loading"></div>');s($type,c,function(){a("#X_Pagination-Bottom .page-numbers").click(function(){l(a(this).attr("href").replace("#",""));return false});$type=="item"&&a("a.xt-jifen-item-exchange").click(function(){var b=a(this),d=b.attr("data-id"),e=b.attr("data-jifen"),
f=b.attr("data-stock");if(e>JIFEN){alert("\u79ef\u5206\u4e0d\u8db3,\u65e0\u6cd5\u5151\u6362");return false}if(f<=0){alert("\u5e93\u5b58\u4e0d\u8db3,\u65e0\u6cd5\u5151\u6362");return false}if(confirm("\u786e\u8ba4\u5151\u6362?\u5151\u6362\u540e\u81ea\u52a8\u6263\u9664\u79ef\u5206!")){if(b.attr("data-valid"))return false;b.attr("data-valid",1);a.ajax({type:"post",dataType:"json",url:XT.ajaxurl+"?rand="+Math.random(),data:{action:"xt_ajax_account_jifen_exchange",id:d},success:function(h){h.code>0?alert(h.msg):
alert("\u5151\u6362\u6210\u529f");b.removeAttr("data-valid")},error:function(){b.removeAttr("data-valid")}})}return false})})}function k(c){$sd=a("#X_Account-Tuiguang-StartDate").val();$ed=a("#X_Account-Tuiguang-EndDate").val();$type=a("#X_Account-Tuiguang-Type li.active a").attr("data-value");a("#X_Account-Tuiguang-List").html('<div id="X_Account-Loading" class="xt-loading"></div>');r($type,c,$sd,$ed,function(){a("#X_Pagination-Bottom .page-numbers").click(function(){k(a(this).attr("href").replace("#",
""));return false});var b=ZeroClipboard.nextId;if(b>1)for(var d=1;d<b;d++)ZeroClipboard.clients[d].destroy();a("#X_Tuiguang-Invite").find(".input-xxlarge").each(function(){var e=a(this),f=new ZeroClipboard.Client;ZeroClipboard.setMoviePath(XT.pluginurl+"/xt-core/js/clipboard/ZeroClipboard.swf");f.setHandCursor(true);f.setText(a(this).val());f.addEventListener("complete",function(){e.select();XT.AtTip(e,"\u590d\u5236\u6210\u529f")});f.glue(e[0])})})}function t(c){a("#X_AmountMsg").hide();var b=c.val();
if(b){if(!/^\d*\.?\d*$/.test(b)){a("#X_AmountMsg").show().text("\u8f93\u5165\u91d1\u989d\u7c7b\u578b\u4e0d\u6b63\u786e");alert("\u8f93\u5165\u91d1\u989d\u7c7b\u578b\u4e0d\u6b63\u786e");return false}var d=c.attr("data-max");c=c.attr("data-min");if(parseFloat(b)<parseFloat(c)){a("#X_AmountMsg").show().text("\u6700\u4f4e\u63d0\u73b0\u91d1\u989d:"+c);alert("\u6700\u4f4e\u63d0\u73b0\u91d1\u989d:"+c);return false}else if(parseFloat(b)>parseFloat(d)){a("#X_AmountMsg").show().text("\u8f93\u5165\u91d1\u989d\u8d85\u8fc7\u4f59\u989d");
alert("\u8f93\u5165\u91d1\u989d\u8d85\u8fc7\u4f59\u989d");return false}}else{a("#X_AmountMsg").show().text("\u8bf7\u8f93\u5165\u63d0\u73b0\u91d1\u989d");alert("\u8bf7\u8f93\u5165\u63d0\u73b0\u91d1\u989d");return false}return parseFloat(b)}function m(c){var b=c.find(".xt-account-datepicker input");b.datepicker({minDate:"2007-1-1",maxDate:new Date,changeMonth:true,changeYear:true,showOtherMonths:true,selectOtherMonths:true,dateFormat:"yy-mm-dd",monthNamesShort:["01","02","03","04","05","06","07","08",
"09","10","11","12"],dayNamesMin:["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"]});b.eq(0).datepicker("option","maxDate",b.eq(1).val());b.eq(1).datepicker("option","minDate",b.eq(0).val());b.eq(0).datepicker("option","onSelect",function(d){b.eq(1).datepicker("option","minDate",d)});b.eq(1).datepicker("option","onSelect",function(d){b.eq(0).datepicker("option","maxDate",d)});b.bind("keydown",function(){return false})}jQuery.extend(jQuery.validator.messages,{required:"\u4e0d\u80fd\u4e3a\u7a7a",
remote:"\u8bf7\u4fee\u6b63\u8be5\u5b57\u6bb5",email:"\u8bf7\u8f93\u5165\u6b63\u786e\u683c\u5f0f\u7684\u7535\u5b50\u90ae\u4ef6",url:"\u8bf7\u8f93\u5165\u5408\u6cd5\u7684\u7f51\u5740",date:"\u8bf7\u8f93\u5165\u5408\u6cd5\u7684\u65e5\u671f",dateISO:"\u8bf7\u8f93\u5165\u5408\u6cd5\u7684\u65e5\u671f (ISO).",number:"\u8bf7\u8f93\u5165\u5408\u6cd5\u7684\u6570\u5b57",digits:"\u53ea\u80fd\u8f93\u5165\u6574\u6570",creditcard:"\u8bf7\u8f93\u5165\u5408\u6cd5\u7684\u4fe1\u7528\u5361\u53f7",equalTo:"\u8bf7\u518d\u6b21\u8f93\u5165\u76f8\u540c\u7684\u503c",
accept:"\u8bf7\u8f93\u5165\u62e5\u6709\u5408\u6cd5\u540e\u7f00\u540d\u7684\u5b57\u7b26\u4e32",maxlength:jQuery.validator.format("\u8bf7\u8f93\u5165\u4e00\u4e2a\u957f\u5ea6\u6700\u591a\u662f {0} \u7684\u5b57\u7b26\u4e32"),minlength:jQuery.validator.format("\u8bf7\u8f93\u5165\u4e00\u4e2a\u957f\u5ea6\u6700\u5c11\u662f {0} \u7684\u5b57\u7b26\u4e32"),rangelength:jQuery.validator.format("\u8bf7\u8f93\u5165\u4e00\u4e2a\u957f\u5ea6\u4ecb\u4e8e {0} \u548c {1} \u4e4b\u95f4\u7684\u5b57\u7b26\u4e32"),range:jQuery.validator.format("\u8bf7\u8f93\u5165\u4e00\u4e2a\u4ecb\u4e8e {0} \u548c {1} \u4e4b\u95f4\u7684\u503c"),
max:jQuery.validator.format("\u8bf7\u8f93\u5165\u4e00\u4e2a\u6700\u5927\u4e3a {0} \u7684\u503c"),min:jQuery.validator.format("\u8bf7\u8f93\u5165\u4e00\u4e2a\u6700\u5c0f\u4e3a {0} \u7684\u503c")});a("#X_Account-Orders-A").click(function(){a("#X_Account-Nav li").removeClass("active");a(this).parent().addClass("active");g("xt-orders",function(){var c=a("#X_Account-Order");m(c);a("#X_Account-Order-Date-Submit").click(function(){j(1)});a("#X_Account-Order-Type a").click(function(){a("#X_Account-Order-Type li").removeClass("active");
a(this).closest("li").addClass("active");j(1)});a("#X_Account-Order-Date-Shortcut a").click(function(){a("#X_Account-Order-Date-Shortcut li").removeClass("active");a(this).closest("li").addClass("active");a("#X_Account-Order-StartDate").val(a(this).attr("data-from"));a("#X_Account-Order-EndDate").val(a(this).attr("data-to"));j(1)});j(1)})});a("#X_Account-Unorders-A").click(function(){a("#X_Account-Nav li").removeClass("active");a(this).parent().addClass("active");g("xt-unorders",function(){var c=
a("#X_Account-Unorder");m(c);a("#X_Account-Unorder-Date-Submit").click(function(){i(1)});a("#X_Account-Unorder-Type a").click(function(){a("#X_Account-Unorder-Type li").removeClass("active");a(this).closest("li").addClass("active");i(1)});a("#X_Account-Unorder-Date-Shortcut a").click(function(){a("#X_Account-Unorder-Date-Shortcut li").removeClass("active");a(this).closest("li").addClass("active");a("#X_Account-Unorder-StartDate").val(a(this).attr("data-from"));a("#X_Account-Unorder-EndDate").val(a(this).attr("data-to"));
i(1)});a("#X_Unorder-Submit").live("click",function(){var b=a("#X_Unorder-TradeId").val();if(!b){alert("\u8bf7\u586b\u5199\u8ba2\u5355\u53f7");a("#X_Unorder-TradeId").focus();return false}var d=a(this);d.button("loading");XT.unOrder(a(this).attr("data-platform"),a(this).attr("data-id"),b,function(e){if(e.code>0)alert(e.msg);else{alert("\u627e\u56de\u6210\u529f");e=d.closest("#X_Modal");e.length==1&&e.modal("hide");i(1)}d.button("reset")},function(e){alert(e.responseText);d.button("reset")})});i(1)})});
a("#X_Account-Tuiguang-A").click(function(){a("#X_Account-Nav li").removeClass("active");a(this).parent().addClass("active");g("xt-tuiguang",function(){var c=a("#X_Account-Tuiguang");m(c);a("#X_Account-Tuiguang-Date-Submit").click(function(){k(1)});a("#X_Account-Tuiguang-Type a").click(function(){a("#X_Account-Tuiguang-Type li").removeClass("active");a(this).closest("li").addClass("active");k(1)});a("#X_Account-Tuiguang-Date-Shortcut a").click(function(){a("#X_Account-Tuiguang-Date-Shortcut li").removeClass("active");
a(this).closest("li").addClass("active");a("#X_Account-Tuiguang-StartDate").val(a(this).attr("data-from"));a("#X_Account-Tuiguang-EndDate").val(a(this).attr("data-to"));k(1)});k(1)})});a("#X_Account-Profile-A").click(function(){a("#X_Account-Nav li").removeClass("active");a(this).parent().addClass("active");g("xt-profile",function(){a("#X_Account-Profile-Form").validate({errorElement:"span",success:function(c,b){a(b).closest(".control-group").removeClass("error")},errorPlacement:function(c,b){b.closest(".control-group").addClass("error");
c.addClass("help-inline");c.insertAfter(b)},submitHandler:function(){var c=a("#X_Account-Profile-Form input,#X_Account-Profile-Form textarea,#X_Account-Profile-Form radio").serializeArray();c=a.param(c);a.ajax({type:"post",dataType:"json",url:XT.ajaxurl,data:c,success:function(b){b.code>0?alert(b.msg):a("#X_Account-Profile-A").click()},error:function(b,d,e){typeof errorCallback!="undefined"&&errorCallback(b,d,e)}})}})})});a("#X_Account-Info-A").click(function(){a("#X_Account-Nav li").removeClass("active");
a(this).parent().addClass("active");g("xt-info")});a("#X_Account-Jifen-A").click(function(){a("#X_Account-Nav li").removeClass("active");a(this).parent().addClass("active");g("xt-jifen",function(){a("#X_Account-Jifen-Type a").click(function(){a("#X_Account-Jifen-Type li").removeClass("active");a(this).closest("li").addClass("active");l(1)});l(1)})});a("#X_Account-Bind-A").click(function(){a("#X_Account-Nav li").removeClass("active");a(this).parent().addClass("active");g("xt-bind",function(){a("#X_Account-Bind .xt-unbind-link").click(function(){o(a(this).attr("data-type"),
function(c){if(c.code>0)alert(c.msg);else{alert("\u89e3\u7ed1\u6210\u529f!");window.location.reload()}})});a("#X_Account-Bind .xt-account-bind-setting").click(function(){var c=[];a(this).parents(".xt-bind-checkbox:first").find('input[type="checkbox"]').each(function(){c.push('"'+a(this).attr("data-value")+'":'+(a(this).is(":checked")?1:0))});p(a(this).attr("data-type"),"{"+c.join(",")+"}",function(b){b.code>0?alert(b.msg):alert("\u4fdd\u5b58\u8bbe\u7f6e\u6210\u529f!")})})})});$paths=[];a('#X_Account-Nav a[href^="#"]').each(function(){$paths.push(a(this).attr("href"))});
if(a.inArray(document.location.hash,$paths)>-1)a('#X_Account-Nav a[href="'+document.location.hash+'"]').click();else parseInt(XT.option.isFanxian)?g("xt-info"):a('#X_Account-Nav a[href="#profile"]').click();a("#X_Account-Profile-Link").live("click",function(){a("#X_Account-Profile-A").click();var c=a(this).closest("#X_Modal");c.length==1&&c.modal("hide");return false});a("#X_Account-Cash-Exchange-Button").live("click",function(){XT.ajaxModal("\u63d0\u73b0",XT.ajaxurl+"?action=xt_ajax_tixian&type=cash",
function(){},"xt-tixian-popup",230);return false});a("#X_Account-Jifen-Exchange-Button").live("click",function(){XT.ajaxModal("\u5151\u6362\u96c6\u5206\u5b9d",XT.ajaxurl+"?action=xt_ajax_tixian&type=jifenbao",function(){},"xt-tixian-popup",230);return false});a("#X_Tixian-Submit").live("click",function(){var c=t(a("#X_Tixian-Amount"));if(c){var b=a(this);b.button("loading");a.ajax({type:"post",dataType:"json",url:XT.ajaxurl+"?rand="+Math.random(),data:{action:"xt_ajax_tixian_save",amount:c,type:b.attr("data-type")},
success:function(d){if(d.code>0)alert(d.msg);else{alert("\u64cd\u4f5c\u6210\u529f!\u8bf7\u7b49\u5f85\u7ba1\u7406\u5458\u652f\u4ed8\u63d0\u73b0");d=b.closest("#X_Modal");d.length==1&&d.modal("hide");document.location.href=document.location.href}b.button("reset")}})}return false})});